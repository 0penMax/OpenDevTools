class Task{constructor(e,t,n="",s=null,o=!1){this.id=e,this.title=t,this.description=n,this.dueDate=s,this.completed=o}}class TaskStore{constructor(){this.tasks=[],this.nextId=1}addTask(e,t,n){const s=new Task(this.nextId++,e,t,n);return this.tasks.push(s),s}getTask(e){return this.tasks.find(t=>t.id===e)||null}updateTask(e,t){const n=this.getTask(e);if(!n)throw new Error(`Task ${e} not found`);return Object.assign(n,t),n}deleteTask(e){const t=this.tasks.findIndex(t=>t.id===e);if(t===-1)throw new Error(`Task ${e} not found`);return this.tasks.splice(t,1)[0]}listTasks(e={}){return this.tasks.filter(t=>(e.completed==null||t.completed===e.completed)&&!(e.dueDate&&t.dueDate>e.dueDate))}}function formatDate(e){if(!e)return"";const t=new Date(e);return t.toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric"})}function createElement(t,n={},...s){const e=document.createElement(t);return Object.entries(n).forEach(([t,n])=>{t==="className"?e.className=n:t.startsWith("on")&&typeof n=="function"?e.addEventListener(t.substring(2).toLowerCase(),n):e.setAttribute(t,n)}),s.forEach(t=>{typeof t=="string"?e.appendChild(document.createTextNode(t)):t instanceof Node&&e.appendChild(t)}),e}class TaskApp{constructor(e){this.store=new TaskStore,this.root=document.getElementById(e),this.init()}init(){this.root.innerHTML="",this.form=this.renderForm(),this.listContainer=createElement("div",{className:"task-list"}),this.root.append(this.form,this.listContainer),this.bindEvents(),this.refreshList()}renderForm(){const e=createElement("input",{type:"text",placeholder:"Title",id:"task-title"}),t=createElement("textarea",{placeholder:"Description",id:"task-desc"}),n=createElement("input",{type:"date",id:"task-due"}),s=createElement("button",{type:"button",onClick:()=>this.handleAdd()},"Add Task");return createElement("div",{className:"task-form"},e,t,n,s)}bindEvents(){document.addEventListener("task:added",()=>this.refreshList()),document.addEventListener("task:updated",()=>this.refreshList()),document.addEventListener("task:deleted",()=>this.refreshList())}handleAdd(){const e=document.getElementById("task-title").value.trim(),t=document.getElementById("task-desc").value.trim(),n=document.getElementById("task-due").value||null;if(!e)return alert("Title is required");this.store.addTask(e,t,n),document.dispatchEvent(new CustomEvent("task:added")),this.clearForm()}handleToggleComplete(e){const t=this.store.getTask(e);this.store.updateTask(e,{completed:!t.completed}),document.dispatchEvent(new CustomEvent("task:updated"))}handleDelete(e){if(!confirm("Delete this task?"))return;this.store.deleteTask(e),document.dispatchEvent(new CustomEvent("task:deleted"))}clearForm(){document.getElementById("task-title").value="",document.getElementById("task-desc").value="",document.getElementById("task-due").value=""}renderTaskItem(e){const t=createElement("span",{className:e.completed?"completed":""},e.title),n=createElement("small",{},formatDate(e.dueDate)),s=createElement("button",{onClick:()=>this.handleToggleComplete(e.id)},e.completed?"Undo":"Complete"),o=createElement("button",{onClick:()=>this.handleDelete(e.id)},"Delete");return createElement("div",{className:"task-item"},t,n,s,o)}refreshList(){this.listContainer.innerHTML="";const e=this.store.listTasks();if(e.length===0){this.listContainer.append(createElement("p",{},"No tasks yet."));return}e.forEach(e=>{this.listContainer.append(this.renderTaskItem(e))})}}document.addEventListener("DOMContentLoaded",()=>{new TaskApp("app")})